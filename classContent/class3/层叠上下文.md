# 层叠上下文

`层叠上下文是浏览器渲染的一项规则，主要解决元素在Z轴有序排列顺序问题，避免发生渲染混乱。（特点：越重要的内容层级越高，越能引起用户的注意，内容 > 布局 > 装饰）`

1、层叠等级

- 在同一个层叠上下文中，它描述定义的是该层叠上下文中的层叠上下文元素在Z轴上的上下顺序。
- 在其他普通元素中，它描述定义的是这些普通元素在Z轴上的上下顺序。

2、层叠上下文的创建

- html的根元素<html></html>具有层叠上下文，称为`根层叠上下文`；
- 普通通元素设置position属性为非static值，产生层叠上下文；
- CSS3中的新属性也可以产生层叠上下文。

3、层叠顺序

- `正z-index > (z-index: auto 或者 z-index:0) > inline/inline-block 水平盒子 > float盒子 > block块状水平盒子 > 负z-index > background/border`

- 如果两个元素层叠上下文相同以及层叠顺序呈现在一个水平，则看元素渲染的先后顺序；

- 如果BFC创建了层叠上下文， 整个元素（包括里面的子元素）层级将会提高；


4、css3 中的层叠上下文

（1）display:flex|inline-flex与层叠上下文
 
 - 条件一：父级需要是display:flex或者display:inline-flex水平；
 - 条件二：子元素的z-index不是auto，必须是数值。此时，这个子元素为层叠上下文元素；

（2）opacity与层叠上下文；

（3）transform与层叠上下文；

（4）mix-blend-mode与层叠上下文；

（5）filter与层叠上下文；

（6）will-change与层叠上下文；

（7）isolation:isolate与层叠上下文；


5、应用场景：

- 页面中元素定位 （固定的头部、固定的底部、弹出层等等）；
- 视差效果；
- ps中的图层；
- canvas 绘制顺序；
- 

6、总结：

- 了解了元素在z轴上的排序规则，清晰了一些以前不了解的遮挡问题；
- 之前认为z-index只有在定位元素上起作用， display:flex|inline-flex下的子元素设置z-index形成层叠上下文；
- 遇到问题，首先去了解背后的设计规则，在规则里去找解决方案；






